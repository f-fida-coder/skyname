"undefined"==typeof FancyBetMultiMarketHandler&&(FancyBetMultiMarketHandler={});
(function(){FancyBetMultiMarketHandler.queryTask=null;FancyBetMultiMarketHandler.init=function(){FancyBetMarketHandler.isEnableFancyBet()&&MultiMarketsHandler.isHasFancybetMultiMarket()&&FancyBetMultiMarketHandler.initTask()};FancyBetMultiMarketHandler.initTask=function(){if(null==FancyBetMultiMarketHandler.queryTask){var a=TaskExecuterV2.createTask(PageConfig.getFancyBetMarketsTaskCycleTime,0,function(){FancyBetMultiMarketHandler.queryFancyBetMultiMarkets(this)});a.version={};a.oddsSettingVersion=
{};a.selectionTs={};FancyBetMultiMarketHandler.queryTask=a}else FancyBetMultiMarketHandler.queryTask.isStop=!1;FancyBetMultiMarketHandler.queryTask.run();TaskExecuterV2.execute()};FancyBetMultiMarketHandler.abortTask=function(){null!=FancyBetMultiMarketHandler.queryTask&&FancyBetMultiMarketHandler.queryTask.stop()};FancyBetMultiMarketHandler.queryFancyBetMultiMarkets=function(a){for(var k=DataBase.multiMarkets.queryAllByCategoryType(CategoryType.FANCY_BET.value),l=[],g=0;g<k.length;g++){var h=k[g],
c=h.eventId;"undefined"==typeof a.version[c]&&(a.version[c]=-1);"undefined"==typeof a.oddsSettingVersion[c]&&(a.oddsSettingVersion[c]=-1);"undefined"==typeof a.selectionTs[c]&&(a.selectionTs[c]=-1);l.push({eventType:h.eventType,eventId:h.eventId,version:a.version[c],oddsSettingVersion:a.oddsSettingVersion[c],selectionTs:a.selectionTs[c]})}$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.landingPath+"/member/playerService/queryFancyBetMultiMarkets",data:{marketPks:JSON.stringify(l)},success:function(e){try{if(e)for(var f=
0;f<e.fancyBets.length;f++){var b=e.fancyBets[f],d=b.eventId;b.version>a.version[d]&&(a.version[d]=Math.max(b.version,a.version[d]));b.oddsSettingVersion>a.oddsSettingVersion[d]&&(a.oddsSettingVersion[d]=Math.max(b.oddsSettingVersion,a.oddsSettingVersion[d]));b.selectionTs>a.selectionTs[d]&&(a.selectionTs[d]=Math.max(b.selectionTs,a.selectionTs[d]));FancyBetMarketHandler.updateFancyBetMarkets(b);FancyBetMarketHandler.updateFancyBetSelections(b)}}catch(m){Trace.printStackTrace(m)}finally{a.check(),
TaskExecuterV2.execute()}},error:function(e,f,b){Trace.log(e.status);Trace.log(b);a.check();TaskExecuterV2.execute()}})}})();

