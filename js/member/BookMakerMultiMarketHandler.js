"undefined"==typeof BookMakerMultiMarketHandler&&(BookMakerMultiMarketHandler={});
(function(){BookMakerMultiMarketHandler.queryTask=null;BookMakerMultiMarketHandler.init=function(){BookMakerMarketHandler.isEnableBookMaker()&&MultiMarketsHandler.isHasBookMakerMultiMarket()&&BookMakerMultiMarketHandler.initTask()};BookMakerMultiMarketHandler.initTask=function(){if(null==BookMakerMultiMarketHandler.queryTask){var a=TaskExecuter.createTask(PageConfig.getBookMakerMarketsTaskCycleTime,0,function(){BookMakerMultiMarketHandler.queryBookMakerMultiMarkets(this)});a.version={};a.oddsSettingVersion=
{};a.selectionTs={};BookMakerMultiMarketHandler.queryTask=a}else BookMakerMultiMarketHandler.queryTask.isStop=!1;BookMakerMultiMarketHandler.queryTask.run();TaskExecuter.execute()};BookMakerMultiMarketHandler.abortTask=function(){null!=BookMakerMultiMarketHandler.queryTask&&BookMakerMultiMarketHandler.queryTask.stop()};BookMakerMultiMarketHandler.queryBookMakerMultiMarkets=function(a){for(var l=DataBase.multiMarkets.queryAllByCategoryType(CategoryType.BOOK_MAKER.value),m=[],g=0,n=l.length;g<n;g++){var h=
l[g],b=h.eventId;"undefined"==typeof a.version[b]&&(a.version[b]=-1);"undefined"==typeof a.oddsSettingVersion[b]&&(a.oddsSettingVersion[b]=-1);"undefined"==typeof a.selectionTs[b]&&(a.selectionTs[b]=-1);m.push({eventType:h.eventType,eventId:h.eventId,version:a.version[b],oddsSettingVersion:a.oddsSettingVersion[b],selectionTs:a.selectionTs[b]})}$j.ajax({type:"POST",dataType:"JSON",url:(PageConfig.enableQueryDataSubdomain&&null!=QueryDataSubDomainUtil.queryHost?QueryDataSubDomainUtil.queryHost:"")+
PageConfig.landingPath+"/member/playerService/queryBookMakerMultiMarkets",data:{marketPks:JSON.stringify(m),queryPass:PageConfig.queryPass},xhrFields:{withCredentials:!0},success:function(e){try{if(e)for(var f=0,k=e.bookMakerInfos.length;f<k;f++){var d=e.bookMakerInfos[f],c=d.bookMakerEvent.eventId;d.version>a.version[c]&&(a.version[c]=Math.max(d.version,a.version[c]));d.oddsSettingVersion>a.oddsSettingVersion[c]&&(a.oddsSettingVersion[c]=Math.max(d.oddsSettingVersion,a.oddsSettingVersion[c]));d.selectionTs>
a.selectionTs[c]&&(a.selectionTs[c]=Math.max(d.selectionTs,a.selectionTs[c]));BookMakerMarketHandler.updateBookMakerMarkets(d)}}catch(p){Trace.printStackTrace(p)}finally{a.check(),TaskExecuter.execute()}},error:function(e,f,k){PageConfig.enableQueryDataSubdomain&&null!=QueryDataSubDomainUtil.queryHost&&!QueryDataSubDomainUtil.isLineDown&&(QueryDataSubDomainUtil.queryHost=null,QueryDataSubDomainUtil.isLineDown=!0);Trace.log(e.status);Trace.log(k);a.check();TaskExecuterV2.execute()}})}})();

